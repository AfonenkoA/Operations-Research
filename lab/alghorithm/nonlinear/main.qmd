# Нелинейное программирование {#sec-lab-alghorithm-nonlinear}

## Задачи

### Струночка

Процедура анализа. Для всех методов требуемых в условии

1. Найти минимум функции простым вызовом метода.
2. С определить количество вычислений функции.
3. С помощью функций trace_\* найти путь поиска решения
5. Построить график поиска решения с точками, в которых была вычислена функция
6. Построить график поиска решения с градиентом.

Одномерные

substitute(la * frac(1L, 1L + exp(-x)) + ca * cos(o\*x) + a * x ^ 2L - b * x)

1. Найти минимум функции
2. Построить график, выделить точку минимума

```{{r}}
f <- function(x) { x^2 - 3 * x + 3 }
goldsectmin(f, -4, 5, m=6)
```

## Минимизация с ограничениями

Определим простую функцию $x^2 - \sqrt{2} x + 1$.
Её минимум очевиден $M=(\frac{1}{\sqrt{2}},\frac{1}{2})$

```{{r}}
f <- \(x) x^2 - sqrt(2)*x + 1
```

plot_ly

Комбинированный метод золотого сечения и обратных парабол method = c("Brent

Аргументами interval или lower, upper задаётся область поиска.
Аргумент maximum отвечает за цель оптимизации.

```{{r}}
optimise(f, c(-5,5))
```

Важный параметр tol, задаёт точность, с которой будет найден оптимум.
Сравним с аналитическим решением разные параметры точности.

```{{r}}
sapply(10^c(-(1:10)),\(t) list(tolerance=t,result=sprintf('%.10f',optimise(f,c(-5,5),tol=t)$minimum ))) |> t()

sprintf('%.10f',1/sqrt(2))
```

## Методы без вычисления производных

1.  Не сходимость если ограничения совпадают
2.  Не локализация, если два экстремума

В связи с особенностью одномерного случая введём для рассмотрения две функции: выпуклую и невыпуклую

### Метод золотого сечения

Алгоритм брента.

```{r}
# optimise()
```

1.  Расходимость при невыпуклой функции

Пауэл и золотое сечение

### Горбы и ямы

Найти безусловный минимум функции двух переменных, провести сравнение из предложенных методов. Графики, анимации, итерации. Нелдермид локальной вариации LBFGS

### Ограничения

Решить задачу с ограничениями

### Овраг

Овраг 4 степени

### Много переменных

Просто сферическая функция

### Условия не писаны

Любым методом Попробовать задать барьерную или штрафную функцию

Уровень 3 попробовать барьерные функиции

Найти условно минимум функции двух переменных, с ограничениями. Использовать доступные методы, провести сравнение.

Свести задачу условной оптимизации к безусловной выбрав барьерные функции. Там где надо применить штрафные или барьерные функции обязательно подробная инструкция

Главное не поскользнуться Найти минимум одномерной функции, построить график, выделить точку.

Гладко было на бумаге, да забыли про овраги

Протестировать методы на функции с известным градиентом и сложным численным градиентом.
