# Безусловная оптимизация функции одной переменной {#sec-nonlinear-unconstrained-analytical-one}

## Определение {#sec-nonlinear-unconstrained-one-def}

::: {#def-nonlinear-unconstrained-one-maximum}

Точкой локального максимума

:   функции $f(x)$ называется точка $x_0$, если существует такая окрестность этой точки, что для всех $x$ из этой окрестности выполняется неравенство: $f(x) < f\left(x_{0}\right)$.
:::

::: {#def-nonlinear-unconstrained-one-minimum}

Точкой локального минимума

:   функции $f(x)$ называется точка $x_0$ , если существует такая окрестность этой точки, что для всех $x$ из этой окрестности выполняется неравенство: $f(x) > f\left(x_{0}\right)$.
:::

@bib-mathprofi-extremum-one @bib-webmath-extremum

## Критерий {#sec-nonlinear-unconstrained-one-criteria}

:::: {#thm-nonlinear-unconstrained-one-necessity}
### Необходимое условие {#sec-nonlinear-unconstrained-one-necessity}

Если функция $y=f(x)$ имеет экстремум в точке $x_{0}$, то ее производная $f^{\prime}\left(x_{0}\right)$ либо равна нулю, либо не существует.

Точки, в которых производная равна нулю: $f^{\prime}(x)=0$, называются стационарными точками функции.

Точки, в которых выполняется необходимое условие экстремума для непрерывной функции, называются критическими точками этой функции. То есть критические точки - это либо стационарные точки (решения уравнения $f^{\prime}(x)=0$), либо это точки, в которых производная $f^{\prime}(x)$ не существует.

::: callout-note
Не в каждой своей критической точке функция обязательно имеет максимум или минимум.
:::
::::

::: {#thm-nonlinear-unconstrained-one-sufficiency-1}
### Первое достаточное условие {#sec-nonlinear-unconstrained-one-sufficiency-1}

Пусть для функции $y=f(x)$ выполнены следующие условия:

1.  функция непрерывна в окрестности точки $x_{0}$
2.  $f^{\prime}\left(x_{0}\right)=0$ или $f^{\prime}\left(x_{0}\right)$ не существует
3.  производная $f^{\prime}(x)$ при переходе через точку $x_{0}$ меняет свой знак.

Тогда в точке $x=x_{0}$ функция $y=f(x)$ имеет экстремум, причем это

-   минимум, если при переходе через точку $x_{0}$ производная меняет свой знак с минуса на плюс;
-   максимум, если при переходе через точку $x_{0}$ производная меняет свой знак с плюса на минус.
:::

::: {#exm-nonlinear-unconstrained-one-sufficiency-1}
Исследовать функцию $y(x)=x^{4}-1$ на экстремум.
:::

::: {#sol-nonlinear-unconstrained-one-sufficiency-1}
Находим производную заданной функции:

$$y^{\prime}=\left(x^{4}-1\right)^{\prime}=4 x^{3}$$

Далее ищем критические точки функции, для этого решаем уравнение $y^{\prime}(x)=0$:

$$y^{\prime}=4 x^{3}=0 \Rightarrow x=0$$

```{r}
#| echo: false
#| message: false
#| warning: false

library(plotly)

x <- seq(-1, 1, length.out = 101)
plot_ly() |> 
  add_trace(x = x, y = ~x^4 - 1, mode='lines', name='функция', type = 'scatter') |>
  add_trace(x = x, y = ~4*x^3, mode='lines', name="производная", type = 'scatter') |>
  pshow() 
```

Первая производная определена во всех точках. Таким образом, имеем одну критическую точку $x=0$. Наносим эту точку на координатную прямую и исследуем знак производной слева и справа от этой точки (для этого из каждого промежутка берем произвольное значение и находим значение производной в выбранной точке, определяем знак полученной величины):

Так как при переходе через точку $x=0$ производная сменила свой знак с $-$ на $+$, то в этой точке функция достигает минимума (или минимального значения), причем $y_{\min }=y(0)=0^{4}-1=-1$.

Замечание. Также можно определить интервалы монотонности функции: так как на интервале $(-\infty ; 0)$ производная $y^{\prime}(x) < 0$, то на этом интервале функция $y(x)=x^{4}-1$ является убывающей; на интервале $(0 ;+\infty)$ производная $y^{\prime}(x)>0$, значит заданная функция возрастает на нем.

Ответ: $y_{\min }=y(0)=-1$
:::

::: {#thm-nonlinear-unconstrained-one-sufficiency-2}
### Второе достаточное условие

Пусть для функции $y=f(x)$ выполнены следующие условия:

1.  она непрерывна в окрестности точки $x_{0}$
2.  первая производная $f^{\prime}(x)=0$ в точке $x_{0}$
3.  $f^{\prime \prime}(x) \neq 0$ в точке $x_{0}$.

Тогда в точке $x_{0}$ достигается экстремум, причем

-   если $f^{\prime \prime}\left(x_{0}\right)>0$, то в точке $x=x_{0}$ функция $y=f(x)$ имеет минимум;
-   если $f^{\prime \prime}\left(x_{0}\right) < 0$, то в точке $x=x_{0}$ функция $y=f(x)$ достигает максимум.
:::

::: {#exm-nonlinear-unconstrained-one-sufficiency-2}
Исследовать функцию $y(x)=\frac{x^{2}-1}{x^{2}+1}$ на экстремум с помощью второй производной.
:::

::: {#sol-nonlinear-unconstrained-one-sufficiency-2}
Находим первую производную заданной функции:

$$y^{\prime}(x)=\left(\frac{x^{2}-1}{x^{2}+1}\right)^{\prime}=\frac{2 x\left(x^{2}+1\right)-\left(x^{2}-1\right) \cdot 2 x}{\left(x^{2}+1\right)^{2}}=\frac{4 x}{\left(x^{2}+1\right)^{2}}$$

Находим точки, в которых первая производная равна нулю:

$$y^{\prime}(x)=0 \Rightarrow \frac{4 x}{\left(x^{2}+1\right)^{2}}=0 \Rightarrow x=0$$

Вторая производная заданной функции:

$$y^{\prime \prime}(x)=\left(\frac{4 x}{\left(x^{2}+1\right)^{2}}\right)^{\prime}=\frac{4\left(x^{2}+1\right)^{2}-4 x \cdot 2\left(x^{2}+1\right) \cdot 2 x}{\left(x^{2}+1\right)^{4}}=$$

$$=-\frac{4\left(3 x^{2}-1\right)}{\left(x^{2}+1\right)^{3}}$$

```{r}
#| echo: false
#| message: false
#| warning: false

library(plotly)

x <- seq(-1, 1, length.out = 101)
plot_ly() |> 
  add_trace(x = x, y = ~(x^2-1)/(x^2+1) - 1, mode='функция', name='функция', type = 'scatter') |>
  add_trace(x = x, y = ~4*x/(x^2+1)^2, mode='lines', name="производная", type = 'scatter') |>
  add_trace(x = x, y = ~-4*(3*x^2-1)/(x^2+1)^3, mode='lines', name='вторая производная', type = 'scatter')  |>
  pshow()
```

В стационарной точке $x=0$ вторая производная $$y^{\prime \prime}(0)=-\frac{4 \cdot(-1)}{1^{3}}=4>0$$

значит, в этой точке функция достигает минимум, причем

$$y_{\min }=y(0)=\frac{0^{2}-1}{0^{2}+1}=-1$$

Ответ $y_{\min }=y(0)=-1$
:::

## Таблица производных {#sec-nonlinear-unconstrained-one-derivatives}

|      $F(x)$      |             $F'(x)=\frac{dF}{dx}$              |
|:----------------:|:----------------------------------------------:|
| $a f(x)+b g(x)$  |               $a f'(x)+b g'(x)$                |
|   $f(x)+g(x)$    |                 $f'(x)+g'(x)$                  |
|   $f(x)-g(x)$    |                 $f'(x)-g'(x)$                  |
|     $a f(x)$     |                   $a f'(x)$                    |
|   $f(x) g(x)$    |           $f'(x) g(x) + f(x) g'(x)$            |
| $f(x) g(x) h(x)$ | $f'(x)g(x)h(x)+ f(x)g'(x)h(x) + f(x)g(x)h'(x)$ |
|    $f(g(x))$     |                $f'(g(x)) g'(x)$                |
|   $a,\ const$    |                      $0$                       |
|      $x^a$       |                  $a x^{n-1}$                   |
|     $g(x)^a$     |               $ag(x)^{a-1}g'(x)$               |
|    $\sin{x}$     |                   $\cos{x}$                    |
|   $\sin{g(x)}$   |               $g'(x) \cos{g(x)}$               |
|    $\cos{x}$     |                   $-\sin{x}$                   |
|    $\tan{x}$     |             $\frac{1}{\cos^2{x}}$              |
|      $e^x$       |                     $e^x$                      |
|    $e^{g(x)}$    |                $g'(x) e^{g(x)}$                |
|      $a^x$       |                  $a^x \ln{a}$                  |
|     $\ln{x}$     |                 $\frac{1}{x}$                  |
|   $\ln{g(x)}$    |              $\frac{g'(x)}{g(x)}$              |
|   $\log_a{x}$    |              $\frac{1}{x \ln{a}}$              |
|   $\arcsin{x}$   |            $\frac{1}{\sqrt{1-x^2}}$            |
| $\arcsin{g(x)}$  |        $\frac{g'(x)}{\sqrt{1-g(x)^2}}$         |
|   $\arccos{x}$   |           $-\frac{1}{\sqrt{1-x^2}}$            |
|   $\arctan{x}$   |               $\frac{1}{1+x^2}$                |
| $\arctan{g(x)}$  |            $\frac{g'(x)}{1+g(x)^2}$            |

: Таблица производных {#tbl-derivatives}
